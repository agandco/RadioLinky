<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <link rel="apple-touch-icon" href="https://i.imgur.com/vsqN1NZ.png">
    <link rel="icon" type="image/png" href="https://i.imgur.com/vsqN1NZ.png">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#000000">
    <meta property="og:title" content="RADIOLINKY">
    <meta property="og:description" content="Radio, MP3 Elite et Gestionnaire de liens.">
    <meta property="og:image" content="https://i.imgur.com/vsqN1NZ.png">
    <meta property="og:url" content="https://radiolinky.com/">
    <title>RADIOLINKY</title>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { 
            --accent: #ffffff; 
            --bg: #000000;     
            --text: #ffffff;   
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body, html { 
            margin: 0; 
            padding: 0; 
            background: var(--bg); 
            color: var(--text); 
            font-family: 'Montserrat', sans-serif; 
            width: 100%;
            height: 100%;
            overflow: hidden;
            -webkit-user-select: none;
            user-select: none;
            -webkit-touch-callout: none;
        }

        .menu-container {
            width: 100%;
            background: var(--bg);
            border-bottom: 2px solid var(--accent);
            z-index: 1000;
        }

        .cat-header { 
            padding: 20px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            cursor: pointer; 
        }

        .cat-header span {
            font-weight: 900;
            letter-spacing: 3px;
            font-size: 1.2rem;
        }

        .menu-content { 
            display: none; 
            padding: 15px;
            grid-template-columns: repeat(2, 1fr); 
            gap: 10px;
            background: #000;
            padding-bottom: 20px;
        }

        .nav-link {
            padding: 15px 0px;
            display: flex; 
            flex-direction: column; 
            align-items: center;
            justify-content: center;
            gap: 8px;
            background: #000; 
            color: #fff;     
            text-decoration: none;
            border-radius: 12px;
            font-weight: 900;
            font-size: 0.75rem;
            border: 2px solid #fff;
            margin-left: 5px;
            margin-right: 5px;
        }

        .nav-link i { width: 20px; height: 20px; }
        .donate-link { border-color: #fff; }

        .app-frame-container {
            width: 100%;
            height: calc(100dvh - 75px); 
            background: #000;
        }

        .app-frame {
            width: 100%;
            height: 100%;
            border: none;
            display: block;
        }
        hr {
            grid-column: span 2;
            width: 100%;
            border: none;
            border-top: 1px solid rgba(255, 255, 255, 0.5); 
            margin: 10px 0;
        }

        small {
            display: block;
            margin-top: 0px;
            margin-bottom: 10px;
            color: var(--accent);
            opacity: 0.6;
            letter-spacing: 1px;
            font-size: 0.75rem;
        }
    </style>
</head>
<body oncontextmenu='return false;' onkeydown='return false;' onmousedown='return false;'>
        
    <div id="pwa-install-container" style="display: none; position: fixed; top: 18px; right: 60px; z-index: 9999;">
        <button id="pwa-install-btn" style="background: #fff; color: #000; border: 2px solid #fff; padding: 8px 15px; border-radius: 50px; font-weight: 900; font-family: 'Montserrat', sans-serif; font-size: 10px; box-shadow: 0 0 15px rgba(255,255,255,0.3); display: flex; align-items: center; gap: 8px; cursor: pointer;">
        <i data-lucide="download" style="width:14px; height:14px;"></i> INSTALLER
        </button>
    </div>

    <div class="menu-container" id="header-menu">
        <div class="cat-header" onclick="toggleMenu()">
            <span>MENU</span>
            <i data-lucide="chevron-down" id="menu-icon" style="transition: 0.3s;"></i>
        </div>
        <div class="menu-content" id="menu-links">
        <small>MUSIQUES :</small><br>
        <a href="radio.html" target="app-viewport" class="nav-link" onclick="handleNav()">
        <i data-lucide="radio"></i>RADIO ELITE
        </a>
        <a href="mp3.html" target="app-viewport" class="nav-link" onclick="handleNav()">
        <i data-lucide="music"></i>MP3 ELITE
        </a>
        <hr>
        <small>OUTILS :</small><br>
        <a href="linky.html" target="app-viewport" class="nav-link" onclick="handleNav()">
        <i data-lucide="link"></i>LINKY
        </a>
        <a href="note.html" target="app-viewport" class="nav-link" onclick="handleNav()">
        <i data-lucide="sticky-note"></i>NOTE ELITE
        </a>
        <hr>
        <small>PARTAGER & SOUTENIR :</small><br>
        <a href="#" class="nav-link" id="share-app-btn">
        <i data-lucide="share-2"></i>PARTAGER
        </a>
        <a href="https://www.paypal.com/donate/?hosted_button_id=VBNVZCGGHFE56" target="_blank" class="nav-link donate-link">
        <i data-lucide="heart"></i>FAIRE UN DON
        </a>
        </div>
    </div>

    <div class="app-frame-container">
        <iframe src="info.html" name="app-viewport" class="app-frame"></iframe>
    </div>

    <script>
        lucide.createIcons();

        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js').catch(err => console.log('SW error:', err));
            });
        }

        function toggleMenu() {
            const content = document.getElementById('menu-links');
            const icon = document.getElementById('menu-icon');
            const isOpen = content.style.display === 'grid';
            content.style.display = isOpen ? 'none' : 'grid';
            icon.style.transform = isOpen ? 'rotate(0deg)' : 'rotate(180deg)';
            updateFrameHeight();
        }

        function updateFrameHeight() {
            const headerHeight = document.getElementById('header-menu').offsetHeight;
            const container = document.querySelector('.app-frame-container');
            container.style.height = `calc(100dvh - ${headerHeight}px)`;
        }

        function handleNav() { toggleMenu(); }

        window.addEventListener('resize', updateFrameHeight);
        window.addEventListener('load', updateFrameHeight);

        let wakeLock = null;
        const requestWakeLock = async () => {
            try {
                if ('wakeLock' in navigator) { wakeLock = await navigator.wakeLock.request('screen'); }
            } catch (err) {}
        };
        requestWakeLock();
        document.addEventListener('visibilitychange', async () => {
            if (wakeLock !== null && document.visibilityState === 'visible') { requestWakeLock(); }
        });
        
        let deferredPrompt;
        const installContainer = document.getElementById('pwa-install-container');
        const installBtn = document.getElementById('pwa-install-btn');

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            if (!window.matchMedia('(display-mode: standalone)').matches) {
                installContainer.style.display = 'block';
            }
        });

        installBtn.addEventListener('click', async () => {
            if (!deferredPrompt) return;
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            if (outcome === 'accepted') { installContainer.style.display = 'none'; }
            deferredPrompt = null;
        });

        window.addEventListener('appinstalled', () => {
            installContainer.style.display = 'none';
            deferredPrompt = null;
        });

        if (window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone) {
            installContainer.style.display = 'none';
        }
        
        const shareLockObserver = new MutationObserver(() => {
            if (typeof state !== 'undefined' && state.current && state.current[state.idx]) {
                const t = state.current[state.idx];
                if (t && t.isMP3) {
                    const shareBtn = document.getElementById('btn-share-stream');
                    if (shareBtn && shareBtn.style.display !== 'none') {
                        shareBtn.style.setProperty('display', 'none', 'important');
                        shareBtn.classList.add('hidden');
                    }
                }
            }
        });
        shareLockObserver.observe(document.body, { childList: true, subtree: true, attributes: true });
    
        document.getElementById('share-app-btn').addEventListener('click', async (e) => {
            e.preventDefault();
            const shareData = {
                title: 'RADIOLINKY',
                text: 'Découvrez le lecteur de radio en ligne et le gestionnaire de favoris, un lecteur MP3 performant et un gestionnaire de liens personnel, le tout disponible sur RADIOLINKY.',
                url: 'https://radiolinky.com'
            };
            try {
                if (navigator.share) {
                    await navigator.share(shareData);
                } else {
                    await navigator.clipboard.writeText(shareData.url);
                    alert('Lien copié dans le presse-papier !');
                }
            } catch (err) {
                console.log('Erreur de partage:', err);
            }
        });
    </script>
</body>
</html>
